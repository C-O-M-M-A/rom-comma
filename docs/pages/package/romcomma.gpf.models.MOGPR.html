<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>romcomma.gpf.models.MOGPR &#8212; rom-comma 1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../../_static/insipid.css?v=b2d00be7" />

    <script src="../../_static/documentation_options.js?v=d6b6a36a"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script defer src="../../_static/insipid.js"></script>
    <script defer src="../../_static/insipid-sidebar.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="romcomma.gpf.tests" href="romcomma.gpf.tests.html" />
    <link rel="prev" title="romcomma.gpf.models" href="romcomma.gpf.models.html" />
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
  </head><body>
    <script type="text/javascript">
        document.body.classList.add('js');
    </script>
    <input type="checkbox" id="sidebar-checkbox" style="display: none;">
    <label id="overlay" for="sidebar-checkbox"></label>
    <div class="sidebar-resize-handle"></div>
    <script type="text/javascript">
        try {
            let sidebar = localStorage.getItem('sphinx-sidebar');
            const sidebar_width = localStorage.getItem('sphinx-sidebar-width');
            if (sidebar_width) {
                document.documentElement.style.setProperty('--sidebar-width', sidebar_width);
            }
            // show sidebar on wide screen
            if (!sidebar && window.matchMedia('(min-width: 100rem)').matches) {
                sidebar = 'visible';
                // NB: We don't store the value in localStorage!
            }
            if (sidebar === 'visible') {
                document.getElementById('sidebar-checkbox').checked = true;
            }
        } catch(e) {
            console.info(e);
        }
    </script>
    <header id="topbar-placeholder">
      <div id="topbar">
        <div id="titlebar">
          <div class="buttons">
            <label for="sidebar-checkbox" id="sidebar-button" role="button" tabindex="0" aria-controls="sphinxsidebar" accesskey="M">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>
            </label>
            <button id="search-button" type="button" title="Search" aria-label="Search" aria-expanded="false" aria-controls="search-form" accesskey="S">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
            </button>
          </div>
          <div class="title">
            <a class="parent" href="romcomma.gpf.models.html" accesskey="U">romcomma.gpf.models</a>
            <a class="top" href="#">romcomma.gpf.models.MOGPR</a>
          </div>
          <div class="buttons">
            <button id="fullscreen-button" type="button" aria-hidden="true">
              <span class="enable">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M212.686 315.314L120 408l32.922 31.029c15.12 15.12 4.412 40.971-16.97 40.971h-112C10.697 480 0 469.255 0 456V344c0-21.382 25.803-32.09 40.922-16.971L72 360l92.686-92.686c6.248-6.248 16.379-6.248 22.627 0l25.373 25.373c6.249 6.248 6.249 16.378 0 22.627zm22.628-118.628L328 104l-32.922-31.029C279.958 57.851 290.666 32 312.048 32h112C437.303 32 448 42.745 448 56v112c0 21.382-25.803 32.09-40.922 16.971L376 152l-92.686 92.686c-6.248 6.248-16.379 6.248-22.627 0l-25.373-25.373c-6.249-6.248-6.249-16.378 0-22.627z"/></svg>
              </span>
              <span class="disable">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M4.686 427.314L104 328l-32.922-31.029C55.958 281.851 66.666 256 88.048 256h112C213.303 256 224 266.745 224 280v112c0 21.382-25.803 32.09-40.922 16.971L152 376l-99.314 99.314c-6.248 6.248-16.379 6.248-22.627 0L4.686 449.941c-6.248-6.248-6.248-16.379 0-22.627zM443.314 84.686L344 184l32.922 31.029c15.12 15.12 4.412 40.971-16.97 40.971h-112C234.697 256 224 245.255 224 232V120c0-21.382 25.803-32.09 40.922-16.971L296 136l99.314-99.314c6.248-6.248 16.379-6.248 22.627 0l25.373 25.373c6.248 6.248 6.248 16.379 0 22.627z"/></svg>
              </span>
            </button>
          </div>
        </div>
        <div id="searchbox" role="search">
          <form id="search-form" class="search" style="display: none" action="../../search.html" method="get">
            <input type="search" name="q" placeholder="Search ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
            <button>Go</button>
          </form>
        </div>
      </div>
    </header>
    <nav>
      <a href="romcomma.gpf.models.html" class="nav-icon previous" title="previous:&#13;romcomma.gpf.models" aria-label="Previous topic" accesskey="P" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>
      </a>
      <a href="romcomma.gpf.tests.html" class="nav-icon next" title="next:&#13;romcomma.gpf.tests" aria-label="Next topic" accesskey="N" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg>
      </a>
    </nav>

    <nav class="relbar">
      <a class="previous" href="romcomma.gpf.models.html" aria-label="Previous topic" >
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"/></svg>
        </div>
        <div class="title">
          <span class="text">
            <span class="direction">previous</span>
            romcomma.gpf.models
          </span>
        </div>
      </a>
      <a class="next" href="romcomma.gpf.tests.html" aria-label="Next topic" >
        <div class="title">
          <span class="text">
            <span class="direction">next</span>
            romcomma.gpf.tests
          </span>
        </div>
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/></svg>
        </div>
      </a>
    </nav>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
<section id="romcomma-gpf-models-mogpr">
<h1>romcomma.gpf.models.MOGPR<a class="headerlink" href="#romcomma-gpf-models-mogpr" title="Link to this heading">§</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MOGPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/romcomma/gpf/models.html#MOGPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#romcomma.gpf.models.MOGPR" title="Link to this definition">§</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GPModel</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">InternalDataTrainingLossMixin</span></code></p>
<p>Gaussian Process Regression.</p>
<p>This is a vanilla implementation of MOGP regression with a Gaussian
likelihood.  Multiple columns of Y are treated independently.</p>
<p>The log likelihood of this model is given by</p>
<div class="math notranslate nohighlight">
\[\log p(Y \,|\, \mathbf f) =
     \mathcal N(Y \,|\, 0, \sigma_n^2 \mathbf{I})\]</div>
<p>To train the model, we maximise the log _marginal_ likelihood
w.r.t. the likelihood variance and kernel hyperparameters theta.
The marginal likelihood is found by integrating the likelihood
over the prior, and has the form</p>
<div class="math notranslate nohighlight">
\[\log p(Y \,|\, \sigma_n, \theta) =
     \mathcal N(Y \,|\, 0, \mathbf{KXX} + \sigma_n^2 \mathbf{I})\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Tuple</em><em>[</em><em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em><em>, </em><em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em><em>]</em>) – </p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="romcomma.gpf.kernels.MOStationary.html#romcomma.gpf.kernels.MOStationary" title="romcomma.gpf.kernels.MOStationary"><em>MOStationary</em></a>) – </p></li>
<li><p><strong>mean_function</strong> (<a class="reference internal" href="romcomma.gpf.mean_functions.MOMeanFunction.html#romcomma.gpf.mean_functions.MOMeanFunction" title="romcomma.gpf.mean_functions.MOMeanFunction"><em>MOMeanFunction</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>noise_variance</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/romcomma/gpf/models.html#MOGPR.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#romcomma.gpf.models.MOGPR.__init__" title="Link to this definition">§</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Tuple</em><em>[</em><em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em><em>, </em><em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em><em>]</em>) – Tuple[InputData, OutputData], which determines L, M and N. Both InputData and OutputData must be of rank 2.</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="romcomma.gpf.kernels.MOStationary.html#romcomma.gpf.kernels.MOStationary" title="romcomma.gpf.kernels.MOStationary"><em>MOStationary</em></a>) – Must be well-formed, with an (L,L) variance and an (L,M) lengthscales matrix.</p></li>
<li><p><strong>mean_function</strong> (<a class="reference internal" href="romcomma.gpf.mean_functions.MOMeanFunction.html#romcomma.gpf.mean_functions.MOMeanFunction" title="romcomma.gpf.mean_functions.MOMeanFunction"><em>MOMeanFunction</em></a><em> | </em><em>None</em>) – Defaults to Zero.</p></li>
<li><p><strong>noise_variance</strong> (<em>float</em>) – Broadcast to (diagonal) (L,L) if necessary.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.__init__" title="romcomma.gpf.models.MOGPR.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(data, kernel[, mean_function, ...])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">param data<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[InputData, OutputData], which determines L, M and N. Both InputData and OutputData must be of rank 2.</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.calc_num_latent_gps" title="romcomma.gpf.models.MOGPR.calc_num_latent_gps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_num_latent_gps</span></code></a>(kernel, likelihood, ...)</p></td>
<td><p>Calculates the number of latent GPs required given the number of outputs <cite>output_dim</cite> and the type of likelihood and kernel.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.calc_num_latent_gps_from_data" title="romcomma.gpf.models.MOGPR.calc_num_latent_gps_from_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_num_latent_gps_from_data</span></code></a>(data, kernel, ...)</p></td>
<td><p>Calculates the number of latent GPs required based on the data as well as the type of kernel and likelihood.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.log_marginal_likelihood" title="romcomma.gpf.models.MOGPR.log_marginal_likelihood"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_marginal_likelihood</span></code></a>()</p></td>
<td><p>Computes the log marginal likelihood.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.log_posterior_density" title="romcomma.gpf.models.MOGPR.log_posterior_density"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_posterior_density</span></code></a>(*args, **kwargs)</p></td>
<td><p>This may be the posterior with respect to the hyperparameters (e.g. for GPR) or the posterior with respect to the function (e.g. for GPMC and SGPMC).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.log_prior_density" title="romcomma.gpf.models.MOGPR.log_prior_density"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_prior_density</span></code></a>()</p></td>
<td><p>Sum of the log prior probability densities of all (constrained) variables in this model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.maximum_log_likelihood_objective" title="romcomma.gpf.models.MOGPR.maximum_log_likelihood_objective"><code class="xref py py-obj docutils literal notranslate"><span class="pre">maximum_log_likelihood_objective</span></code></a>()</p></td>
<td><p>Objective for maximum likelihood estimation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.predict_f" title="romcomma.gpf.models.MOGPR.predict_f"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_f</span></code></a>(Xnew[, full_cov, full_output_cov])</p></td>
<td><p>This method computes predictions at X in R^{N x D} input points</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.predict_f_samples" title="romcomma.gpf.models.MOGPR.predict_f_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_f_samples</span></code></a>(Xnew[, num_samples, ...])</p></td>
<td><p>Produce samples from the posterior latent function(s) at the input points.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.predict_log_density" title="romcomma.gpf.models.MOGPR.predict_log_density"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_log_density</span></code></a>(data[, full_cov, ...])</p></td>
<td><p>Compute the log density of the data at the new data points.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.predict_y" title="romcomma.gpf.models.MOGPR.predict_y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_y</span></code></a>(Xnew[, full_cov, full_output_cov])</p></td>
<td><p>Compute the mean and variance of the held-out data at the input points.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.training_loss" title="romcomma.gpf.models.MOGPR.training_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">training_loss</span></code></a>()</p></td>
<td><p>Returns the training loss for this model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.training_loss_closure" title="romcomma.gpf.models.MOGPR.training_loss_closure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">training_loss_closure</span></code></a>(*[, compile])</p></td>
<td><p>Convenience method.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.with_name_scope" title="romcomma.gpf.models.MOGPR.with_name_scope"><code class="xref py py-obj docutils literal notranslate"><span class="pre">with_name_scope</span></code></a>(method)</p></td>
<td><p>Decorator to automatically enter the module name scope.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">KXX</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.L" title="romcomma.gpf.models.MOGPR.L"><code class="xref py py-obj docutils literal notranslate"><span class="pre">L</span></code></a></p></td>
<td><p>The output dimensionality.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.M" title="romcomma.gpf.models.MOGPR.M"><code class="xref py py-obj docutils literal notranslate"><span class="pre">M</span></code></a></p></td>
<td><p>The input dimensionality.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.name" title="romcomma.gpf.models.MOGPR.name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code></a></p></td>
<td><p>Returns the name of this module as passed or determined in the ctor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.name_scope" title="romcomma.gpf.models.MOGPR.name_scope"><code class="xref py py-obj docutils literal notranslate"><span class="pre">name_scope</span></code></a></p></td>
<td><p>Returns a <cite>tf.name_scope</cite> instance for this class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.non_trainable_variables" title="romcomma.gpf.models.MOGPR.non_trainable_variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_variables</span></code></a></p></td>
<td><p>Sequence of non-trainable variables owned by this module and its submodules.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.submodules" title="romcomma.gpf.models.MOGPR.submodules"><code class="xref py py-obj docutils literal notranslate"><span class="pre">submodules</span></code></a></p></td>
<td><p>Sequence of all sub-modules.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_parameters</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.trainable_variables" title="romcomma.gpf.models.MOGPR.trainable_variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_variables</span></code></a></p></td>
<td><p>Sequence of trainable variables owned by this module and its submodules.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#romcomma.gpf.models.MOGPR.variables" title="romcomma.gpf.models.MOGPR.variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">variables</span></code></a></p></td>
<td><p>Sequence of variables owned by this module and its submodules.</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.M">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">M</span></span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.M" title="Link to this definition">§</a></dt>
<dd><p>The input dimensionality.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.L">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">L</span></span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.L" title="Link to this definition">§</a></dt>
<dd><p>The output dimensionality.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.maximum_log_likelihood_objective">
<span class="sig-name descname"><span class="pre">maximum_log_likelihood_objective</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/romcomma/gpf/models.html#MOGPR.maximum_log_likelihood_objective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#romcomma.gpf.models.MOGPR.maximum_log_likelihood_objective" title="Link to this definition">§</a></dt>
<dd><p>Objective for maximum likelihood estimation. Should be maximized. E.g.
log-marginal likelihood (hyperparameter likelihood) for GPR, or lower
bound to the log-marginal likelihood (ELBO) for sparse and variational
GPs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.log_marginal_likelihood">
<span class="sig-name descname"><span class="pre">log_marginal_likelihood</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/romcomma/gpf/models.html#MOGPR.log_marginal_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#romcomma.gpf.models.MOGPR.log_marginal_likelihood" title="Link to this definition">§</a></dt>
<dd><p>Computes the log marginal likelihood.</p>
<div class="math notranslate nohighlight">
\[\log p(Y | \theta).\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.predict_f">
<span class="sig-name descname"><span class="pre">predict_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/romcomma/gpf/models.html#MOGPR.predict_f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#romcomma.gpf.models.MOGPR.predict_f" title="Link to this definition">§</a></dt>
<dd><p>This method computes predictions at X in R^{N x D} input points</p>
<div class="math notranslate nohighlight">
\[p(F* | Y)\]</div>
<p>where F* are points on the MOGP at new data points, Y are noisy observations at training data points.
Note that full_cov =&gt; full_output_cov (regardless of the ordinate given for full_output_cov), to avoid ambiguity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Xnew</strong> (<em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em>) – </p></li>
<li><p><strong>full_cov</strong> (<em>bool</em>) – </p></li>
<li><p><strong>full_output_cov</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[<a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a>, <a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.calc_num_latent_gps">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calc_num_latent_gps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.calc_num_latent_gps" title="Link to this definition">§</a></dt>
<dd><p>Calculates the number of latent GPs required given the number of
outputs <cite>output_dim</cite> and the type of likelihood and kernel.</p>
<p>Note: It’s not nice for <cite>GPModel</cite> to need to be aware of specific
likelihoods as here. However, <cite>num_latent_gps</cite> is a bit more broken in
general, we should fix this in the future. There are also some slightly
problematic assumptions re the output dimensions of mean_function.
See <a class="reference external" href="https://github.com/GPflow/GPflow/issues/1343">https://github.com/GPflow/GPflow/issues/1343</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel</strong> (<em>Kernel</em>) – </p></li>
<li><p><strong>likelihood</strong> (<em>Likelihood</em>) – </p></li>
<li><p><strong>output_dim</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.calc_num_latent_gps_from_data">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calc_num_latent_gps_from_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.calc_num_latent_gps_from_data" title="Link to this definition">§</a></dt>
<dd><p>Calculates the number of latent GPs required based on the data as well
as the type of kernel and likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Tuple</em><em>[</em><em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em><em>, </em><em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em><em>]</em>) – </p></li>
<li><p><strong>kernel</strong> (<em>Kernel</em>) – </p></li>
<li><p><strong>likelihood</strong> (<em>Likelihood</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.log_posterior_density">
<span class="sig-name descname"><span class="pre">log_posterior_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.log_posterior_density" title="Link to this definition">§</a></dt>
<dd><p>This may be the posterior with respect to the hyperparameters (e.g. for
GPR) or the posterior with respect to the function (e.g. for GPMC and
SGPMC). It assumes that maximum_log_likelihood_objective() is defined
sensibly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.log_prior_density">
<span class="sig-name descname"><span class="pre">log_prior_density</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.log_prior_density" title="Link to this definition">§</a></dt>
<dd><p>Sum of the log prior probability densities of all (constrained) variables in this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.name" title="Link to this definition">§</a></dt>
<dd><p>Returns the name of this module as passed or determined in the ctor.</p>
<p>NOTE: This is not the same as the <cite>self.name_scope.name</cite> which includes
parent module names.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.name_scope">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name_scope</span></span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.name_scope" title="Link to this definition">§</a></dt>
<dd><p>Returns a <cite>tf.name_scope</cite> instance for this class.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.non_trainable_variables">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">non_trainable_variables</span></span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.non_trainable_variables" title="Link to this definition">§</a></dt>
<dd><p>Sequence of non-trainable variables owned by this module and its submodules.</p>
<p>Note: this method uses reflection to find variables on the current instance
and submodules. For performance reasons you may wish to cache the result
of calling this method if you don’t expect the return value to change.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A sequence of variables for the current module (sorted by attribute
name) followed by variables from all submodules recursively (breadth
first).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.predict_f_samples">
<span class="sig-name descname"><span class="pre">predict_f_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.predict_f_samples" title="Link to this definition">§</a></dt>
<dd><p>Produce samples from the posterior latent function(s) at the input points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Xnew</strong> (<em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em>) – InputData
Input locations at which to draw samples, shape […, N, D]
where N is the number of rows and D is the input dimension of each point.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em> | </em><em>None</em>) – Number of samples to draw.
If <cite>None</cite>, a single sample is drawn and the return shape is […, N, P],
for any positive integer the return shape contains an extra batch
dimension, […, S, N, P], with S = num_samples and P is the number of outputs.</p></li>
<li><p><strong>full_cov</strong> (<em>bool</em>) – If True, draw correlated samples over the inputs. Computes the Cholesky over the
dense covariance matrix of size [num_data, num_data].
If False, draw samples that are uncorrelated over the inputs.</p></li>
<li><p><strong>full_output_cov</strong> (<em>bool</em>) – If True, draw correlated samples over the outputs.
If False, draw samples that are uncorrelated over the outputs.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a></p>
</dd>
</dl>
<p>Currently, the method does not support <cite>full_output_cov=True</cite> and <cite>full_cov=True</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.predict_log_density">
<span class="sig-name descname"><span class="pre">predict_log_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.predict_log_density" title="Link to this definition">§</a></dt>
<dd><p>Compute the log density of the data at the new data points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Tuple</em><em>[</em><em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em><em>, </em><em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em><em>]</em>) – </p></li>
<li><p><strong>full_cov</strong> (<em>bool</em>) – </p></li>
<li><p><strong>full_output_cov</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.predict_y">
<span class="sig-name descname"><span class="pre">predict_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.predict_y" title="Link to this definition">§</a></dt>
<dd><p>Compute the mean and variance of the held-out data at the input points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Xnew</strong> (<em>ndarray</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>] </em><em>| </em><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a><em> | </em><em>Variable</em><em> | </em><em>Parameter</em>) – </p></li>
<li><p><strong>full_cov</strong> (<em>bool</em>) – </p></li>
<li><p><strong>full_output_cov</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[<a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a>, <a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.submodules">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">submodules</span></span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.submodules" title="Link to this definition">§</a></dt>
<dd><p>Sequence of all sub-modules.</p>
<p>Submodules are modules which are properties of this module, or found as
properties of modules which are properties of this module (and so on).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Module</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Module</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Module</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">submodules</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">submodules</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">submodules</span><span class="p">)</span> <span class="o">==</span> <span class="p">[]</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A sequence of all submodules.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.trainable_variables">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trainable_variables</span></span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.trainable_variables" title="Link to this definition">§</a></dt>
<dd><p>Sequence of trainable variables owned by this module and its submodules.</p>
<p>Note: this method uses reflection to find variables on the current instance
and submodules. For performance reasons you may wish to cache the result
of calling this method if you don’t expect the return value to change.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A sequence of variables for the current module (sorted by attribute
name) followed by variables from all submodules recursively (breadth
first).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.training_loss">
<span class="sig-name descname"><span class="pre">training_loss</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.training_loss" title="Link to this definition">§</a></dt>
<dd><p>Returns the training loss for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.training_loss_closure">
<span class="sig-name descname"><span class="pre">training_loss_closure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.training_loss_closure" title="Link to this definition">§</a></dt>
<dd><p>Convenience method. Returns a closure which itself returns the training loss. This closure
can be passed to the minimize methods on <code class="xref py py-class docutils literal notranslate"><span class="pre">gpflow.optimizers.Scipy</span></code> and subclasses of
<cite>tf.optimizers.Optimizer</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>compile</strong> (<em>bool</em>) – If <cite>True</cite> (default), compile the training loss function in a TensorFlow
graph by wrapping it in tf.function()</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Callable</em>[[], <a class="reference internal" href="romcomma.base.definitions.TF.html#romcomma.base.definitions.TF.Tensor" title="tensorflow.python.framework.tensor.Tensor"><em>Tensor</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.variables">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variables</span></span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.variables" title="Link to this definition">§</a></dt>
<dd><p>Sequence of variables owned by this module and its submodules.</p>
<p>Note: this method uses reflection to find variables on the current instance
and submodules. For performance reasons you may wish to cache the result
of calling this method if you don’t expect the return value to change.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A sequence of variables for the current module (sorted by attribute
name) followed by variables from all submodules recursively (breadth
first).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="romcomma.gpf.models.MOGPR.with_name_scope">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">with_name_scope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#romcomma.gpf.models.MOGPR.with_name_scope" title="Link to this definition">§</a></dt>
<dd><p>Decorator to automatically enter the module name scope.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyModule</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="gp">... </span>  <span class="nd">@tf</span><span class="o">.</span><span class="n">Module</span><span class="o">.</span><span class="n">with_name_scope</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">):</span>
<span class="gp">... </span>      <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the above module would produce <a href="#id1"><span class="problematic" id="id2">`</span></a>tf.Variable`s and <a href="#id3"><span class="problematic" id="id4">`</span></a>tf.Tensor`s whose
names included the module name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">MyModule</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="go">&lt;tf.Tensor: shape=(1, 3), dtype=float32, numpy=..., dtype=float32)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">w</span>
<span class="go">&lt;tf.Variable &#39;my_module/Variable:0&#39; shape=(2, 3) dtype=float32,</span>
<span class="go">numpy=..., dtype=float32)&gt;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>method</strong> – The method to wrap.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The original method wrapped such that it enters the module’s name scope.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

          <div class="sidebar-resize-handle"></div>

<h3><a href="../../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../start.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../start.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../start.html#conceptual-hierarchy">Conceptual Hierarchy</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../start.html#module-hierarchy">Module Hierarchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../start.html#glossary">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="reference.html">Module Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="romcomma.base.html">romcomma.base</a></li>
<li class="toctree-l2"><a class="reference internal" href="romcomma.data.html">romcomma.data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="romcomma.gpf.html">romcomma.gpf</a></li>
<li class="toctree-l2"><a class="reference internal" href="romcomma.gpr.html">romcomma.gpr</a></li>
<li class="toctree-l2"><a class="reference internal" href="romcomma.gsa.html">romcomma.gsa</a></li>
<li class="toctree-l2"><a class="reference internal" href="romcomma.rom.html">romcomma.rom</a></li>
<li class="toctree-l2"><a class="reference internal" href="romcomma.user.html">romcomma.user</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

<div><hr class="docutils"></div>
<ul>
  <li class="toctree-l1"><a class="reference internal" href="../../genindex.html" accesskey="I">General Index</a></li>
  <li class="toctree-l1"><a class="reference internal" href="../../py-modindex.html">Python Module Index</a></li>
</ul>
<div id="ethical-ad-placement"></div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <nav class="relbar">
      <a class="previous" href="romcomma.gpf.models.html" aria-label="Previous topic" >
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"/></svg>
        </div>
        <div class="title">
          <span class="text">
            <span class="direction">previous</span>
            romcomma.gpf.models
          </span>
        </div>
      </a>
      <a class="next" href="romcomma.gpf.tests.html" aria-label="Next topic" >
        <div class="title">
          <span class="text">
            <span class="direction">next</span>
            romcomma.gpf.tests
          </span>
        </div>
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/></svg>
        </div>
      </a>
    </nav>

    <footer role="contentinfo">
      &#169; Copyright 2023, Robert A. Milton.
      Created using <a class="reference external" href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
      <a class="reference external" href="https://insipid-sphinx-theme.readthedocs.io/">Insipid Theme</a>.
<a class="reference internal" href="../../_sources/pages/package/romcomma.gpf.models.MOGPR.rst.txt" rel="nofollow">Show Source</a>.
    </footer>
  </body>
</html>